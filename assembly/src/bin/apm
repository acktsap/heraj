#!/bin/bash
# resolve links - $0 may be a softlink
if [ -z "$APM_HOME" ];then
  PRG="$0"
  while [ -h "$PRG" ] ; do
    ls=$(ls -ld "$PRG")
    link=$(expr "$ls" : '.*-> \(.*\)$')
    if expr "$link" : '/.*' > /dev/null; then
      PRG="$link"
    else
      PRG=$(dirname "$PRG")/"$link"
    fi
  done

  cd "$(dirname "$PRG")/.." || exit 1
  APM_HOME="$(pwd)"
  export APM_HOME
  cd - &>/dev/null || exit 1
fi

# Directory definitions
export APM_BIN=${APM_BIN:-$APM_HOME/bin}
export APM_CONF=${APM_CONF:-$APM_HOME/conf}
export APM_DOC=${APM_DOC:-$APM_HOME/doc}
export APM_LIB=${APM_LIB:-$APM_HOME/lib}

JARS=$(find "$APM_LIB" -name '*.jar' | tr '\n' ':')

echo "java -cp $APM_CONF:$JARS -Dlogback.configurationFile=$APM_CONF/apm-logger.xml hera.exec.ApmLauncher $@"
java -cp $APM_CONF:$JARS -Dlogback.configurationFile=$APM_CONF/apm-logger.xml hera.exec.ApmLauncher $@
